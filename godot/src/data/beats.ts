/**
 * @license
 * SPDX-License-Identifier: Apache-2.0
*/
import { Beat } from '../beat/types';

export const BEATS: Beat[] = [
  {
    id: "beat.shrine.oath-or-price",
    trigger: { verbs: ["invoke", "pledge"], tags: ["shrine", "oath"] },
    weight: 30,
    cooldown: { steps: 3 },
    context_tags: ["ash-fen", "spirit"],
    compose: {
      requires: ["site:Whisper-Knot Shrine"],
      grants: ["mark:SPIRIT-BOUND|1"],
      costs: [{ resource: "CLARITY", amount: 2 }],
      effects: [
        "faction:Lantern Court +1 if oath honored later",
        "pressure:rumor_heat +5",
      ],
      echoTemplateId: "echo.oath_sworn",
    },
  },
  {
    id: "beat.market.rumor-trade",
    trigger: { verbs: ["barter", "ask_about"], tags: ["market", "rumor"] },
    weight: 40,
    cooldown: { steps: 2 },
    context_tags: ["ivythorn", "trade"],
    compose: {
      requires: ["site:Caravan of Thorns"],
      grants: ["rumor:new", "item:Roadkeeper’s Token?5%"],
      costs: [{ resource: "TIME", amount: 1 }],
      effects: ["pressure:scarcity -2", "faction:Roadkeepers +1"],
      echoTemplateId: "echo.rumor_seeded",
    },
  },
  {
    id: "beat.ruin.lens-of-the-old-sky",
    trigger: { verbs: ["study", "scribe"], tags: ["ruin", "memory"] },
    weight: 20,
    cooldown: { steps: 4 },
    context_tags: ["salt-steppe", "star"],
    compose: {
      requires: ["site:Salt-Glass Observatory"],
      grants: ["clue:constellation", "relic:Salt Lens?10%"],
      costs: [{ resource: "CLARITY", amount: 1 }],
      effects: ["pressure:retaliation +3 (Salt Covenant)"],
      echoTemplateId: "echo.memory_recovered",
    },
  },
  {
    id: "beat.road.bind-and-pass",
    trigger: { verbs: ["travel", "invoke"], tags: ["road"] },
    weight: 35,
    cooldown: { steps: 2 },
    context_tags: ["amber-dunes", "journey"],
    compose: {
      requires: ["site:Milestone XIII"],
      grants: ["buff:hazard_road -1 tier for next leg"],
      costs: [{ resource: "TIME", amount: 1 }],
      effects: ["pressure:rumor_heat +2"],
      echoTemplateId: "echo.road_bound",
    },
  },
  {
    id: "beat.hall.mask-baptism",
    trigger: { verbs: ["mask", "scribe"], tags: ["craft", "identity"] },
    weight: 25,
    cooldown: { steps: 3 },
    context_tags: ["basalt-ridge", "craft"],
    compose: {
      requires: ["site:Maskwright Hall", "relic:Blank Reed Mask"],
      grants: ["mask:BAPTIZED", "recognition:+2 Maskwrights"],
      costs: [{ resource: "TIME", amount: 2 }],
      effects: ["pressure:retaliation +2 (rival faction random)"],
      echoTemplateId: "echo.mask_forged",
    },
  },
  {
    id: "beat.well.truth-or-depth",
    trigger: { verbs: ["invoke", "study"], tags: ["spirit", "water"] },
    weight: 20,
    cooldown: { steps: 4 },
    context_tags: ["drowned-vale", "omen"],
    compose: {
      requires: ["site:Whispering Well"],
      grants: ["hazard:reveal next", "mark:SPIRIT-TOUCHED?15%"],
      costs: [{ resource: "CLARITY", amount: 2 }],
      effects: ["faction:Mirebound +1/-1 depending on truth"],
      echoTemplateId: "echo.truth_offered",
    },
  },
  {
    id: "beat.gate.toll-or-trade",
    trigger: { verbs: ["barter", "travel"], tags: ["gate", "road"] },
    weight: 30,
    cooldown: { steps: 3 },
    context_tags: ["ivythorn", "journey"],
    compose: {
      requires: ["site:Briar Gate"],
      grants: ["rumor:new", "faction:Roadkeepers +1 if toll paid"],
      costs: [{ resource: "TIME", amount: 1 }],
      effects: [
        "recognition:-1 if toll evaded",
        "pressure:retaliation +2",
      ],
      echoTemplateId: "echo.toll_paid",
    },
  },
  {
    id: "beat.kiln.fire-or-ruin",
    trigger: { verbs: ["study", "remember"], tags: ["kiln", "craft"] },
    weight: 25,
    cooldown: { steps: 3 },
    context_tags: ["ash-fen", "fire"],
    compose: {
      requires: ["site:Peatfire Kiln"],
      grants: ["artifact:new", "rumor:craft_secret"],
      costs: [{ resource: "TIME", amount: 1 }],
      effects: ["pressure:scarcity -2"],
      echoTemplateId: "echo.artifact_fired",
    },
  },
  {
    id: "beat.cistern.water-for-journey",
    trigger: { verbs: ["invoke", "travel"], tags: ["cistern", "water"] },
    weight: 30,
    cooldown: { steps: 2 },
    context_tags: ["amber-dunes", "travel"],
    compose: {
      requires: ["site:Wanderer’s Cistern"],
      grants: ["buff:next_travel_success"],
      costs: [{ resource: "CLARITY", amount: 1 }],
      effects: ["faction:Roadkeepers +1"],
      echoTemplateId: "echo.journey_marked",
    },
  },
  {
    id: "beat.hut.song-oath",
    trigger: { verbs: ["invoke", "pledge"], tags: ["song", "oath"] },
    weight: 35,
    cooldown: { steps: 2 },
    context_tags: ["ivythorn", "song"],
    compose: {
      requires: ["site:Thorn Cantor’s Hut"],
      grants: ["mark:SONG-BOUND"],
      costs: [{ resource: "CLARITY", amount: 1 }],
      effects: ["pressure:rumor_heat +2"],
      echoTemplateId: "echo.oath_chanted",
    },
  },
  {
    id: "beat.mill.salt-bargain",
    trigger: { verbs: ["barter", "claim"], tags: ["mill", "salt"] },
    weight: 20,
    cooldown: { steps: 3 },
    context_tags: ["salt-steppe", "trade"],
    compose: {
      requires: ["site:Brine Mill"],
      grants: ["resource:salt_stockpile"],
      costs: [{ resource: "TIME", amount: 2 }],
      effects: ["faction:Salt Covenant +1/-1 depending outcome"],
      echoTemplateId: "echo.salt_milled",
    },
  },
  {
    id: "beat.forge.relic-smithing",
    trigger: { verbs: ["study", "mask"], tags: ["forge", "craft"] },
    weight: 15,
    cooldown: { steps: 4 },
    context_tags: ["basalt-ridge", "relic"],
    compose: {
      requires: ["site:Smoking Forge"],
      grants: ["relic:new_forged"],
      costs: [{ resource: "TIME", amount: 2 }],
      effects: ["pressure:retaliation +3"],
      echoTemplateId: "echo.relic_forged",
    },
  },
  {
    id: "beat.court.name-for-name",
    trigger: { verbs: ["claim", "scribe"], tags: ["court", "claim"] },
    weight: 30,
    cooldown: { steps: 3 },
    context_tags: ["ash-fen", "law"],
    compose: {
      requires: ["site:Reed Court"],
      grants: ["claim:dispute_resolved", "rumor:verdict_posted"],
      costs: [{ resource: "TIME", amount: 2 }],
      effects: ["faction:Mirebound +1/-1 by ruling", "pressure:retaliation ±2"],
      echoTemplateId: "echo.claim_adjudicated",
    },
  },
  {
    id: "beat.gate.check-or-pass",
    trigger: { verbs: ["travel", "barter"], tags: ["gate", "toll"] },
    weight: 35,
    cooldown: { steps: 2 },
    context_tags: ["salt-steppe", "checkpoint"],
    compose: {
      requires: ["site:White Road Gate"],
      grants: ["buff:next_travel_success", "item:Roadchalk?20%"],
      costs: [{ resource: "TIME", amount: 1 }],
      effects: ["recognition:+1 Roadkeepers if paid", "pressure:scarcity -1"],
      echoTemplateId: "echo.gate_passed",
    },
  },
  {
    id: "beat.choir.rocksong-lesson",
    trigger: { verbs: ["study", "scribe"], tags: ["music", "echo"] },
    weight: 20,
    cooldown: { steps: 4 },
    context_tags: ["basalt-ridge", "hymn"],
    compose: {
      requires: ["site:Basalt Choir"],
      grants: ["clue:hymn_phrase", "rite:Stone Witnessing?15%"],
      costs: [{ resource: "CLARITY", amount: 1 }],
      effects: ["pressure:rumor_heat +1"],
      echoTemplateId: "echo.hymn_learned",
    },
  },
  {
    id: "beat.dais.bless-the-steps",
    trigger: { verbs: ["invoke", "pledge"], tags: ["ritual", "journey"] },
    weight: 25,
    cooldown: { steps: 3 },
    context_tags: ["amber-dunes", "song"],
    compose: {
      requires: ["site:Sand Choir Dais"],
      grants: ["buff:hazard_road -1 tier", "mark:SONG-BOUND?10%"],
      costs: [{ resource: "TIME", amount: 1 }],
      effects: ["faction:Roadkeepers +1"],
      echoTemplateId: "echo.journey_blessed",
    },
  },
  {
    id: "beat.library.drowned-pages",
    trigger: { verbs: ["search", "remember"], tags: ["ruin", "memory"] },
    weight: 20,
    cooldown: { steps: 4 },
    context_tags: ["drowned-vale", "lore"],
    compose: {
      requires: ["site:Sinking Archive"],
      grants: ["clue:lore_excerpt", "echo:minor_memory"],
      costs: [{ resource: "TIME", amount: 2 }],
      effects: ["clarity:-1", "pressure:retaliation +1 (Mirebound if stolen)"],
      echoTemplateId: "echo.memory_recovered",
    },
  },
  {
    id: "beat.gallows.recall-the-dead",
    trigger: { verbs: ["remember", "scribe"], tags: ["execution", "memory"] },
    weight: 25,
    cooldown: { steps: 3 },
    context_tags: ["ash-fen", "spirit"],
    compose: {
      requires: ["site:Fen Gallows"],
      grants: ["clue:execution_name"],
      costs: [{ resource: "CLARITY", amount: 1 }],
      effects: ["pressure:rumor_heat +2"],
      echoTemplateId: "echo.dead_named",
    },
  },
  {
    id: "beat.spire.shard-study",
    trigger: { verbs: ["study", "search"], tags: ["star", "ruin"] },
    weight: 20,
    cooldown: { steps: 4 },
    context_tags: ["amber-dunes", "star"],
    compose: {
      requires: ["site:Glassbone Annex"],
      grants: ["relic:Glassbone Splinter?10%", "rumor:constellation"],
      costs: [{ resource: "TIME", amount: 2 }],
      effects: ["clarity:-1"],
      echoTemplateId: "echo.shard_found",
    },
  },
  {
    id: "beat.grove.silence-trial",
    trigger: { verbs: ["study", "invoke"], tags: ["grove", "silence"] },
    weight: 30,
    cooldown: { steps: 2 },
    context_tags: ["ivythorn", "silence"],
    compose: {
      requires: ["site:Hush Grove"],
      grants: ["buff:mask_next +1", "mark:SILENT?10%"],
      costs: [{ resource: "CLARITY", amount: 1 }],
      effects: ["pressure:scarcity -1"],
      echoTemplateId: "echo.silence_kept",
    },
  },
  {
    id: "beat.monastery.vigil-oath",
    trigger: { verbs: ["pledge", "invoke"], tags: ["monastery", "oath"] },
    weight: 25,
    cooldown: { steps: 3 },
    context_tags: ["basalt-ridge", "vow"],
    compose: {
      requires: ["site:Cliff Monastery"],
      grants: ["mark:VIGIL-KEEPER", "rumor:monk_testimony"],
      costs: [{ resource: "TIME", amount: 2 }],
      effects: ["faction:Maskwrights +1"],
      echoTemplateId: "echo.oath_recorded",
    },
  },
  {
    id: "beat.jetty.bell-toll",
    trigger: { verbs: ["travel", "barter"], tags: ["dock", "ferry"] },
    weight: 35,
    cooldown: { steps: 2 },
    context_tags: ["drowned-vale", "ferry"],
    compose: {
      requires: ["site:Bellboat Jetty"],
      grants: ["rumor:sea_path", "buff:travel -1 time cost next leg"],
      costs: [{ resource: "TIME", amount: 1 }],
      effects: ["faction:Mirebound +1"],
      echoTemplateId: "echo.journey_departed",
    },
  },
];
